<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta name="format-detection" content="telephone=no">
	<meta content="telephone=no" name="format-detection">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="stylesheet" href="assets/stylesheets/style.css" type="text/css" /> 
    <script language="javascript" type="text/javascript" src="./assets/javascript/size.js"></script>
    <script language="javascript" type="text/javascript" src="./assets/javascript/jquery-2.1.4.min.js"></script>
    <script  language="javascript" type="text/javascript" src="./assets/javascript/tools.js"></script>
    <!-- <script  language="javascript" type="text/javascript" src="./assets/javascript/vconsole.min.js"></script> -->
    <script language="javascript" type="text/javascript" src="./assets/javascript/exif.min.js"></script>
    <script language="javascript" type="text/javascript" src="./assets/javascript/megapix-image.min.js"></script>
    <script  language="javascript" type="text/javascript" src="./assets/javascript/zshimage.js"></script>
    <title>demo样板</title>
    <style>
        .ctrol{display: block; width: 300px; height: 30px; background: #ddd; border:1px solid #aaa;}
        .img{ max-width: 100%; margin:30px 0;}
    </style>
</head>
<body>
    
    <input class="ctrol" type="file" id="J_file" placeholder="选择图片" accept="image/*" />
    <img src="" class="img" id="J_img">
    <p>原图信息：<span id="J_or"></span></p>
    <p>压缩后信息：<span id="J_ora"></span></p>
    <br /><br /><br />
    <input type="text" class="ctrol" id="J_url" placeholder="请输入地址" value="./img/img06.jpeg" />
    <img src="" class="img" id="J_imga">
    <p>原图信息：<span id="J_orb"></span></p>
    <p>压缩后信息：<span id="J_orc"></span></p>
    <script>
        $(function(){
            var J_file = $('#J_file');

            // 宽高设置优先最大宽高设置
            J_file.on('change',function(e){
                readImageInfo({file:J_file[0].files[0],callback:function(rs){
                    $('#J_or').html(JSON.stringify(rs))
                }})
                zshImageCompress({
                    file:J_file[0].files[0],
                    // width:400,
                    // height:400,
                    maxWidth:300,
                    maxHeight:300,
                    quality:.8,
                    success:function(rs){
                        // console.log(5,rs)
                        $('#J_img').attr('src',rs)
                        readImageInfo({base64:rs,callback:function(rs){
                            $('#J_ora').html(JSON.stringify(rs))
                        }})
                    }
                })
            })

            $('#J_url').on('blur',function(){
                // 
                var v = $(this).val().trim();
                readImageInfo({src:v,callback:function(rs){
                    $('#J_orb').html(JSON.stringify(rs))
                }})
                zshImageCompress({
                    url:v,
                    // width:400,
                    // height:400,
                    maxWidth:300,
                    maxHeight:300,
                    quality:1,
                    success:function(rs){
                        // console.log(5,rs)
                        $('#J_imga').attr('src',rs)
                        readImageInfo({base64:rs,callback:function(rs){
                            $('#J_orc').html(JSON.stringify(rs))
                        }})
                    }
                })
            })

        })
    </script>
</body>
</html>
